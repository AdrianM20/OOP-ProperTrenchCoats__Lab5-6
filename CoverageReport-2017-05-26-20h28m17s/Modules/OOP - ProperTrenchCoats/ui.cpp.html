<!doctype html>
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
        <meta charset="utf-8"/>
	    <title>ui.cpp</title>
	    <link href="../../third-party/google-code-prettify/prettify-CppCoverage.css" type="text/css" rel="stylesheet" />
	    <script type="text/javascript" src="../../third-party/google-code-prettify/prettify.js"></script>
	</head>
	<body onload="prettyPrint()">
        <h4></h4>
		<pre class="prettyprint lang-cpp linenums">
#include "UI.h"
#include &lt;string&gt;
#include &lt;iostream&gt;

using namespace std;

void UI::printMenu()
<span style = "background-color:#fdd">{
	cout &lt;&lt; "\n||------------Choose an option---------------||" &lt;&lt; endl;
	cout &lt;&lt; "|| 1 - Administrator mode                    ||" &lt;&lt; endl;
	cout &lt;&lt; "|| 2 - Client mode                           ||" &lt;&lt; endl;
	cout &lt;&lt; "|| 0 - Exit program                          ||" &lt;&lt; endl;
	cout &lt;&lt; "||------------Choose an option---------------||" &lt;&lt; endl;
}</span>

void UI::printRepositoryMenu()
<span style = "background-color:#fdd">{
	cout &lt;&lt; "\n||----------Possible commands----------||" &lt;&lt; endl;
	cout &lt;&lt; "|| 1 - Add coat                        ||" &lt;&lt; endl;
	cout &lt;&lt; "|| 2 - Display all coats               ||" &lt;&lt; endl;
	cout &lt;&lt; "|| 3 - Delete coat                     ||" &lt;&lt; endl;
	cout &lt;&lt; "|| 4 - Update coat                     ||" &lt;&lt; endl;
	cout &lt;&lt; "|| 0 - Back                            ||" &lt;&lt; endl;
	cout &lt;&lt; "||----------Possible commands----------||" &lt;&lt; endl;
}</span>

void UI::printShoppingCartMenu()
<span style = "background-color:#fdd">{
	cout &lt;&lt; "\n||----------Possible commands----------||" &lt;&lt; endl;
	cout &lt;&lt; "|| 1 - See trench coats                ||" &lt;&lt; endl;
	cout &lt;&lt; "|| 2 - Add coat to cart                ||" &lt;&lt; endl;
	cout &lt;&lt; "|| 3 - Next coat                       ||" &lt;&lt; endl;
	cout &lt;&lt; "|| 4 - See shopping cart               ||" &lt;&lt; endl;
	cout &lt;&lt; "|| 0 - Back                            ||" &lt;&lt; endl;
	cout &lt;&lt; "||----------Possible commands----------||" &lt;&lt; endl;
}</span>

bool UI::is_number(const std::string &amp; s)
<span style = "background-color:#fdd">{
	return std::all_of(s.begin(), s.end(), ::isdigit);
}</span>

void UI::addCoatToRepo()
<span style = "background-color:#fdd">{
	cout &lt;&lt; "Enter the coat ID(must be 5 charanters): ";
	std::string ID;
	getline(cin, ID);
	cout &lt;&lt; "Enter size: ";</span>
	int size;
<span style = "background-color:#fdd">	cin &gt;&gt; size;
	cin.ignore();
	cout &lt;&lt; "Enter colour: ";
	std::string colour;
	getline(cin, colour);
	cout &lt;&lt; "Enter price: ";</span>
	double price;
<span style = "background-color:#fdd">	cin &gt;&gt; price;
	cin.ignore();
	cout &lt;&lt; "Enter quantity: ";</span>
	int quantity;
<span style = "background-color:#fdd">	cin &gt;&gt; quantity;
	cin.ignore();
	cout &lt;&lt; "Enter link: ";
	std::string link;
	getline(cin, link);
	this-&gt;ctrl.addCoatToRepository(ID, size, colour, price, quantity, link);
}</span>

void UI::displayAllCoatsRepo()
<span style = "background-color:#fdd">{
	std::vector&lt;Coat&gt; coats = this-&gt;ctrl.getAllCoats();
	for (int i = 0; i &lt; coats.size(); i++) {
		cout &lt;&lt; "Coat ID: " &lt;&lt; coats[i].getID() &lt;&lt; " ";
		cout &lt;&lt; "|| Size: " &lt;&lt; coats[i].getSize() &lt;&lt; " ";
		cout &lt;&lt; "|| Colour: " &lt;&lt; coats[i].getColour() &lt;&lt; " ";
		cout &lt;&lt; "|| Price: " &lt;&lt; coats[i].getPrice() &lt;&lt; " ";
		cout &lt;&lt; "|| Quantity: " &lt;&lt; coats[i].getQuantity() &lt;&lt; endl;
	}
}</span>

void UI::removeCoatFromRepo()
<span style = "background-color:#fdd">{
	cout &lt;&lt; "Enter coat ID you want to remove: ";
	std::string ID;
	getline(cin, ID);
	this-&gt;ctrl.removeCoatFromRepository(ID);
}</span>

void UI::updateCoatFromRepo()
<span style = "background-color:#fdd">{
	cout &lt;&lt; "Enter the ID for the coat you want to update: ";
	std::string ID;
	getline(cin, ID);
	cout &lt;&lt; "Enter the new price for coat: ";</span>
	double new_price;
<span style = "background-color:#fdd">	cin &gt;&gt; new_price;
	cin.ignore();
	cout &lt;&lt; "Enter the new quantity for coat: ";</span>
	int new_quantity;
<span style = "background-color:#fdd">	cin &gt;&gt; new_quantity;
	cin.ignore();
	cout &lt;&lt; "Enter new link for coat image: ";
	std::string new_link;
	getline(cin, new_link);
	this-&gt;ctrl.updateCoatToRepository(ID, new_price, new_quantity, new_link);
}</span>

void UI::addSizeCoats()
<span style = "background-color:#fdd">{
	cout &lt;&lt; "Enter the size for your coat: ";
	std::string size_str;
	getline(cin, size_str);
	if (size_str.empty()) {
		this-&gt;ctrl.clearProducts();
		this-&gt;ctrl.addAllAvailableCoats();</span>
	}
<span style = "background-color:#fdd">	else {
		if (UI::is_number(size_str)) {
			int size_i = stoi(size_str);
			this-&gt;ctrl.clearProducts();
			this-&gt;ctrl.addAllSizeCoats(size_i);</span>
		}
<span style = "background-color:#fdd">		else
			throw "Wrong input for coat size. Make sure you type in just numbers.";</span>
	}
<span style = "background-color:#fdd">}</span>

void UI::showCart()
<span style = "background-color:#fdd">{
	std::vector&lt;Coat&gt; coatsInCart = this-&gt;ctrl.getCart().getCartContents();
	cout &lt;&lt; "\nProducts in shopping cart: " &lt;&lt; endl;
	for (int i = 0; i &lt; coatsInCart.size(); i++) {
		cout &lt;&lt; "Colour: " &lt;&lt; coatsInCart[i].getColour() &lt;&lt; " ";
		cout &lt;&lt; "|| Size: " &lt;&lt; coatsInCart[i].getSize() &lt;&lt; " ";
		cout &lt;&lt; "|| Price: " &lt;&lt; coatsInCart[i].getPrice() &lt;&lt; endl;
	}
	if (this-&gt;ctrl.getCart().isEmpty())
		cout &lt;&lt; "\nThe shopping cart is empty" &lt;&lt; endl;
	cout &lt;&lt; "\n\tTotal Cost: " &lt;&lt; this-&gt;ctrl.getCart().totalCost() &lt;&lt; endl;
	cout &lt;&lt; "\nWhat would you lie to do?" &lt;&lt; endl;
	cout &lt;&lt; "1 - Buy coats" &lt;&lt; endl;
	cout &lt;&lt; "2 - Remove everything from cart" &lt;&lt; endl;
	cout &lt;&lt; "0 - Continue shopping" &lt;&lt; endl;
	cout &lt;&lt; "\nInput command: ";</span>
	int command;
<span style = "background-color:#fdd">	cin &gt;&gt; command;
	cin.ignore();</span>

<span style = "background-color:#fdd">	switch (command)</span>
	{
	case 1: {
<span style = "background-color:#fdd">		if (this-&gt;ctrl.getCart().isEmpty())
			cout &lt;&lt; "Cannot buy because cart is empty." &lt;&lt; endl;
		else
			this-&gt;ctrl.buyProducts();
		break;</span>
	}
	case 2: {
<span style = "background-color:#fdd">		this-&gt;ctrl.eraseCart();</span>
		break;
	}
	case 0: { break; }
	}
<span style = "background-color:#fdd">}</span>

void UI::run()
<span style = "background-color:#fdd">{
	while (true)</span>
	{
		try {
<span style = "background-color:#fdd">			UI::printMenu();
			int command{ 0 };
			cout &lt;&lt; "|| Input command: ";
			cin &gt;&gt; command;
			cin.ignore();
			if (command == 0)
				break;</span>

			// Administrator mode
<span style = "background-color:#fdd">			if (command == 1)</span>
			{
<span style = "background-color:#fdd">				while (true)</span>
				{
<span style = "background-color:#fdd">					UI::printRepositoryMenu();
					int commandRepo{ 0 };
					cout &lt;&lt; "|| Input command: ";
					cin &gt;&gt; commandRepo;
					cin.ignore();
					if (commandRepo == 0)
						break;</span>

<span style = "background-color:#fdd">					switch (commandRepo)</span>
					{
					case 1: {
						try {
<span style = "background-color:#fdd">							this-&gt;addCoatToRepo();</span>
						}
<span style = "background-color:#fdd">						catch (const char* msg) {
							cerr &lt;&lt; msg &lt;&lt; endl;
						}
						break;</span>
					}
					case 2: {
<span style = "background-color:#fdd">						this-&gt;displayAllCoatsRepo();
						break;</span>
					}
					case 3: {
						try {
<span style = "background-color:#fdd">							this-&gt;removeCoatFromRepo();</span>
						}
<span style = "background-color:#fdd">						catch (const char* msg) {
							cerr &lt;&lt; msg &lt;&lt; endl;
						}
						break;</span>
					}
					case 4: {
						try {
<span style = "background-color:#fdd">							this-&gt;updateCoatFromRepo();</span>
						}
<span style = "background-color:#fdd">						catch (const char* msg) {
							cerr &lt;&lt; msg &lt;&lt; endl;
						}</span>
						break;
					}
					} //end of switch
<span style = "background-color:#fdd">				} //</span>
			}    // end of admin

				 // User Mode
<span style = "background-color:#fdd">			if (command == 2)</span>
			{
<span style = "background-color:#fdd">				UI::addSizeCoats();
				while (true)</span>
				{
<span style = "background-color:#fdd">					UI::printShoppingCartMenu();
					int commandUser{ 0 };
					cout &lt;&lt; "|| Input command: ";
					cin &gt;&gt; commandUser;
					cin.ignore();
					if (commandUser == 0)
						break;</span>

<span style = "background-color:#fdd">					switch (commandUser)</span>
					{
					case 1: {
						try {
<span style = "background-color:#fdd">							if (this-&gt;ctrl.getCart().noProducts()) {
								cout &lt;&lt; "No coats available." &lt;&lt; endl;
								break;</span>
							}
<span style = "background-color:#fdd">							this-&gt;ctrl.startShopping();
							Coat c = this-&gt;ctrl.getCart().getCurrentCoat();
							cout &lt;&lt; "\nNow showing: " &lt;&lt; endl;
							cout &lt;&lt; "\tSize: " &lt;&lt; c.getSize() &lt;&lt; endl;
							cout &lt;&lt; "\tColour: " &lt;&lt; c.getColour() &lt;&lt; endl;
							cout &lt;&lt; "\tPrice: " &lt;&lt; c.getPrice() &lt;&lt; endl;
							std::string availability = "";
							if (c.getQuantity() &gt; 3)
								availability = "In Stock";
							else if (c.getQuantity() &lt;= 3)
									availability = "Limited Stock";
							else availability = "Out of stock";
							cout &lt;&lt; "\tAvailability: " &lt;&lt; availability &lt;&lt; endl;
							cout &lt;&lt; "\n\tTotal Cost: " &lt;&lt; this-&gt;ctrl.getCart().totalCost() &lt;&lt; endl;
						}
						catch (const char* msg) {
							cerr &lt;&lt; msg &lt;&lt; endl;
						}
						break;</span>
					}
					case 2: {
						try {
<span style = "background-color:#fdd">							if (this-&gt;ctrl.getCart().getCurrentCoat().getQuantity() &lt; 1) {
								cout &lt;&lt; "This item is out of stock. It will not be added to you shopping cart." &lt;&lt; endl;
								continue;</span>
							}
<span style = "background-color:#fdd">							Coat c = this-&gt;ctrl.getCart().getCurrentCoat();
							this-&gt;ctrl.addCoatToCart(c);
							cout &lt;&lt; "\n\tTotal Cost: " &lt;&lt; this-&gt;ctrl.getCart().totalCost() &lt;&lt; endl;
						}
						catch (const char* msg) {
							cerr &lt;&lt; msg &lt;&lt; endl;
						}
						break;</span>
					}
					case 3: {
						try {
<span style = "background-color:#fdd">							if (this-&gt;ctrl.getCart().noProducts()) {
								cout &lt;&lt; "No coats available." &lt;&lt; endl;
								break;</span>
							}
<span style = "background-color:#fdd">							this-&gt;ctrl.nextCoatShopping();
							Coat c = this-&gt;ctrl.getCart().getCurrentCoat();
							cout &lt;&lt; "\nNow showing: " &lt;&lt; endl;
							cout &lt;&lt; "\tSize: " &lt;&lt; c.getSize() &lt;&lt; endl;
							cout &lt;&lt; "\tColour: " &lt;&lt; c.getColour() &lt;&lt; endl;
							cout &lt;&lt; "\tPrice: " &lt;&lt; c.getPrice() &lt;&lt; endl;
							std::string availability = "";
							if (c.getQuantity() &gt; 3)
								availability = "In Stock";
							else if (c.getQuantity() &lt;= 3 &amp;&amp; c.getQuantity() &gt; 0)
								availability = "Limited Stock";
							else availability = "Out of stock";
							cout &lt;&lt; "\tAvailability: " &lt;&lt; availability &lt;&lt; endl;
							cout &lt;&lt; "\n\tTotal Cost: " &lt;&lt; this-&gt;ctrl.getCart().totalCost() &lt;&lt; endl;
						}
						catch (const char* msg) {
							cerr &lt;&lt; msg &lt;&lt; endl;
						}
						break;</span>
					}
					case 4: {
						try {
<span style = "background-color:#fdd">							UI::showCart();</span>
						}
<span style = "background-color:#fdd">						catch (const char* msg) {
							cerr &lt;&lt; msg &lt;&lt; endl;
						}</span>
						break;
					}
					} //end of switch
<span style = "background-color:#fdd">				} //</span>
			}    // end of user
		}
<span style = "background-color:#fdd">		catch (const char* msg) {
			cerr &lt;&lt; msg &lt;&lt; endl;
		}
	}
}</span></pre>
	</body>
</html>